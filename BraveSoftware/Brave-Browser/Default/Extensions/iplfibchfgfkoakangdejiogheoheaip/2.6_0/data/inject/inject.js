!(function(){window.screenLensSelector&&window.screenLensSelector.cleanup();class t{constructor(){this.overlay=null,this.selection=null,this.isSelecting=!1,this.startX=0,this.startY=0,this.topTint=null,this.bottomTint=null,this.leftTint=null,this.rightTint=null,this.handleMouseDown=this.handleMouseDown.bind(this),this.handleMouseMove=this.handleMouseMove.bind(this),this.handleMouseUp=this.handleMouseUp.bind(this)}start(){this.overlay=document.createElement("div"),this.overlay.className="screen-lens-overlay",this.topTint=document.createElement("div"),this.bottomTint=document.createElement("div"),this.leftTint=document.createElement("div"),this.rightTint=document.createElement("div"),[this.topTint,this.bottomTint,this.leftTint,this.rightTint].forEach((t=>{t.style.position="fixed",t.style.background="rgba(255, 165, 0, 0.3)",t.style.zIndex="2147483647",t.style.pointerEvents="none"})),this.topTint.style.left="0",this.topTint.style.top="0",this.topTint.style.width="100%",this.topTint.style.height="100%",document.body.appendChild(this.topTint),this.overlay.addEventListener("mousedown",this.handleMouseDown),document.body.appendChild(this.overlay),document.body.appendChild(this.bottomTint),document.body.appendChild(this.leftTint),document.body.appendChild(this.rightTint)}handleMouseDown(t){0===t.button&&(t.preventDefault(),t.stopPropagation(),this.startX=t.clientX,this.startY=t.clientY,this.isSelecting=!0,this.selection=document.createElement("div"),this.selection.className="screen-lens-selection",document.body.appendChild(this.selection),document.addEventListener("mousemove",this.handleMouseMove,!0),document.addEventListener("mouseup",this.handleMouseUp,!0))}handleMouseMove(t){if(!this.isSelecting)return;const i=Math.min(t.clientX,this.startX),h=Math.min(t.clientY,this.startY),s=Math.abs(t.clientX-this.startX),e=Math.abs(t.clientY-this.startY);Object.assign(this.selection.style,{left:i+"px",top:h+"px",width:s+"px",height:e+"px"}),Object.assign(this.topTint.style,{left:"0",top:"0",width:"100%",height:h+"px"}),Object.assign(this.bottomTint.style,{left:"0",top:h+e+"px",width:"100%",height:`calc(100% - ${h+e}px)`}),Object.assign(this.leftTint.style,{left:"0",top:h+"px",width:i+"px",height:e+"px"}),Object.assign(this.rightTint.style,{left:i+s+"px",top:h+"px",width:`calc(100% - ${i+s}px)`,height:e+"px"})}handleMouseUp(t){if(!this.isSelecting)return;this.isSelecting=!1;const i=this.selection.getBoundingClientRect();this.cleanup();try{chrome.runtime.sendMessage({method:"captured",left:i.left,top:i.top,width:i.width,height:i.height,devicePixelRatio:window.devicePixelRatio,title:document.title,service:window.service})}catch(h){}}cleanup(){this.overlay&&this.overlay.removeEventListener("mousedown",this.handleMouseDown),document.removeEventListener("mousemove",this.handleMouseMove,!0),document.removeEventListener("mouseup",this.handleMouseUp,!0),[".screen-lens-overlay",".screen-lens-selection",".itrisearch-box",".itrisearch-guide-1",".itrisearch-guide-2",".itrisearch-guide-3"].forEach((t=>{document.querySelectorAll(t).forEach((t=>t.remove()))})),["selection","overlay","topTint","bottomTint","leftTint","rightTint"].forEach((t=>{this[t]&&(this[t].remove(),this[t]=null)}))}}window.hasScreenLensSelector=!0,window.screenLensSelector=new t,window.screenLensSelector.start(),window.addEventListener("unload",(()=>{window.screenLensSelector&&window.screenLensSelector.cleanup(),window.hasScreenLensSelector=!1})),chrome.runtime.onMessage.addListener(((i,h,s)=>("activate_selector"===i.action&&(window.screenLensSelector&&window.screenLensSelector.cleanup(),window.screenLensSelector=new t,window.screenLensSelector.start()),!0)))})();