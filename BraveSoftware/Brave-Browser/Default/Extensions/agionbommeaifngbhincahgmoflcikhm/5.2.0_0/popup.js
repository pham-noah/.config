/*! For license information please see popup.js.LICENSE.txt */
(()=>{var e={61:(e,t,n)=>{var o=n(698).default;function r(){"use strict";e.exports=r=function(){return n},e.exports.__esModule=!0,e.exports.default=e.exports;var t,n={},a=Object.prototype,i=a.hasOwnProperty,s=Object.defineProperty||function(e,t,n){e[t]=n.value},c="function"==typeof Symbol?Symbol:{},l=c.iterator||"@@iterator",d=c.asyncIterator||"@@asyncIterator",u=c.toStringTag||"@@toStringTag";function m(e,t,n){return Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{m({},"")}catch(t){m=function(e,t,n){return e[t]=n}}function p(e,t,n,o){var r=t&&t.prototype instanceof b?t:b,a=Object.create(r.prototype),i=new A(o||[]);return s(a,"_invoke",{value:P(e,n,i)}),a}function f(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(e){return{type:"throw",arg:e}}}n.wrap=p;var g="suspendedStart",h="suspendedYield",v="executing",y="completed",w={};function b(){}function C(){}function x(){}var $={};m($,l,(function(){return this}));var M=Object.getPrototypeOf,L=M&&M(M(D([])));L&&L!==a&&i.call(L,l)&&($=L);var I=x.prototype=b.prototype=Object.create($);function k(e){["next","throw","return"].forEach((function(t){m(e,t,(function(e){return this._invoke(t,e)}))}))}function z(e,t){function n(r,a,s,c){var l=f(e[r],e,a);if("throw"!==l.type){var d=l.arg,u=d.value;return u&&"object"==o(u)&&i.call(u,"__await")?t.resolve(u.__await).then((function(e){n("next",e,s,c)}),(function(e){n("throw",e,s,c)})):t.resolve(u).then((function(e){d.value=e,s(d)}),(function(e){return n("throw",e,s,c)}))}c(l.arg)}var r;s(this,"_invoke",{value:function(e,o){function a(){return new t((function(t,r){n(e,o,t,r)}))}return r=r?r.then(a,a):a()}})}function P(e,n,o){var r=g;return function(a,i){if(r===v)throw new Error("Generator is already running");if(r===y){if("throw"===a)throw i;return{value:t,done:!0}}for(o.method=a,o.arg=i;;){var s=o.delegate;if(s){var c=T(s,o);if(c){if(c===w)continue;return c}}if("next"===o.method)o.sent=o._sent=o.arg;else if("throw"===o.method){if(r===g)throw r=y,o.arg;o.dispatchException(o.arg)}else"return"===o.method&&o.abrupt("return",o.arg);r=v;var l=f(e,n,o);if("normal"===l.type){if(r=o.done?y:h,l.arg===w)continue;return{value:l.arg,done:o.done}}"throw"===l.type&&(r=y,o.method="throw",o.arg=l.arg)}}}function T(e,n){var o=n.method,r=e.iterator[o];if(r===t)return n.delegate=null,"throw"===o&&e.iterator.return&&(n.method="return",n.arg=t,T(e,n),"throw"===n.method)||"return"!==o&&(n.method="throw",n.arg=new TypeError("The iterator does not provide a '"+o+"' method")),w;var a=f(r,e.iterator,n.arg);if("throw"===a.type)return n.method="throw",n.arg=a.arg,n.delegate=null,w;var i=a.arg;return i?i.done?(n[e.resultName]=i.value,n.next=e.nextLoc,"return"!==n.method&&(n.method="next",n.arg=t),n.delegate=null,w):i:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,w)}function S(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function E(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function A(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(S,this),this.reset(!0)}function D(e){if(e||""===e){var n=e[l];if(n)return n.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var r=-1,a=function n(){for(;++r<e.length;)if(i.call(e,r))return n.value=e[r],n.done=!1,n;return n.value=t,n.done=!0,n};return a.next=a}}throw new TypeError(o(e)+" is not iterable")}return C.prototype=x,s(I,"constructor",{value:x,configurable:!0}),s(x,"constructor",{value:C,configurable:!0}),C.displayName=m(x,u,"GeneratorFunction"),n.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===C||"GeneratorFunction"===(t.displayName||t.name))},n.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,x):(e.__proto__=x,m(e,u,"GeneratorFunction")),e.prototype=Object.create(I),e},n.awrap=function(e){return{__await:e}},k(z.prototype),m(z.prototype,d,(function(){return this})),n.AsyncIterator=z,n.async=function(e,t,o,r,a){void 0===a&&(a=Promise);var i=new z(p(e,t,o,r),a);return n.isGeneratorFunction(t)?i:i.next().then((function(e){return e.done?e.value:i.next()}))},k(I),m(I,u,"Generator"),m(I,l,(function(){return this})),m(I,"toString",(function(){return"[object Generator]"})),n.keys=function(e){var t=Object(e),n=[];for(var o in t)n.push(o);return n.reverse(),function e(){for(;n.length;){var o=n.pop();if(o in t)return e.value=o,e.done=!1,e}return e.done=!0,e}},n.values=D,A.prototype={constructor:A,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(E),!e)for(var n in this)"t"===n.charAt(0)&&i.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=t)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var n=this;function o(o,r){return s.type="throw",s.arg=e,n.next=o,r&&(n.method="next",n.arg=t),!!r}for(var r=this.tryEntries.length-1;r>=0;--r){var a=this.tryEntries[r],s=a.completion;if("root"===a.tryLoc)return o("end");if(a.tryLoc<=this.prev){var c=i.call(a,"catchLoc"),l=i.call(a,"finallyLoc");if(c&&l){if(this.prev<a.catchLoc)return o(a.catchLoc,!0);if(this.prev<a.finallyLoc)return o(a.finallyLoc)}else if(c){if(this.prev<a.catchLoc)return o(a.catchLoc,!0)}else{if(!l)throw new Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return o(a.finallyLoc)}}}},abrupt:function(e,t){for(var n=this.tryEntries.length-1;n>=0;--n){var o=this.tryEntries[n];if(o.tryLoc<=this.prev&&i.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var r=o;break}}r&&("break"===e||"continue"===e)&&r.tryLoc<=t&&t<=r.finallyLoc&&(r=null);var a=r?r.completion:{};return a.type=e,a.arg=t,r?(this.method="next",this.next=r.finallyLoc,w):this.complete(a)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),w},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),E(n),w}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var o=n.completion;if("throw"===o.type){var r=o.arg;E(n)}return r}}throw new Error("illegal catch attempt")},delegateYield:function(e,n,o){return this.delegate={iterator:D(e),resultName:n,nextLoc:o},"next"===this.method&&(this.arg=t),w}},n}e.exports=r,e.exports.__esModule=!0,e.exports.default=e.exports},698:e=>{function t(n){return e.exports=t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},e.exports.__esModule=!0,e.exports.default=e.exports,t(n)}e.exports=t,e.exports.__esModule=!0,e.exports.default=e.exports},687:(e,t,n)=>{var o=n(61)();e.exports=o;try{regeneratorRuntime=o}catch(e){"object"==typeof globalThis?globalThis.regeneratorRuntime=o:Function("r","regeneratorRuntime = r")(o)}}},t={};function n(o){var r=t[o];if(void 0!==r)return r.exports;var a=t[o]={exports:{}};return e[o](a,a.exports,n),a.exports}n.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return n.d(t,{a:t}),t},n.d=(e,t)=>{for(var o in t)n.o(t,o)&&!n.o(e,o)&&Object.defineProperty(e,o,{enumerable:!0,get:t[o]})},n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),(()=>{"use strict";function e(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,o=new Array(t);n<t;n++)o[n]=e[n];return o}function t(e,t,n,o,r,a,i){try{var s=e[a](i),c=s.value}catch(e){return void n(e)}s.done?t(c):Promise.resolve(c).then(o,r)}function o(e){return function(){var n=this,o=arguments;return new Promise((function(r,a){var i=e.apply(n,o);function s(e){t(i,r,a,s,c,"next",e)}function c(e){t(i,r,a,s,c,"throw",e)}s(void 0)}))}}var r=n(687),a=n.n(r);const i=function(e,t){var n=document.createElement("a");n.download=e,n.href=t,n.click()};function s(){return(s=o(a().mark((function e(t,n){var o,r,i;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t&&n){e.next=2;break}return e.abrupt("return",null);case 2:if(o=document.createElement("canvas"),r=new Image,i="jpg"===n.toLowerCase()?"jpeg":n.toLowerCase(),["png","jpeg","webp"].includes(i)){e.next=7;break}return e.abrupt("return",null);case 7:return e.next=9,new Promise((function(e){r.addEventListener("load",(function(){return e(!0)})),r.addEventListener("error",(function(){return e(!1)})),r.crossOrigin="Anonymous",r.src=t,r.convertToType=i}));case 9:if(e.sent){e.next=12;break}return e.abrupt("return",null);case 12:return o.width=r.naturalWidth,o.height=r.naturalHeight,o.getContext("2d").drawImage(r,0,0),e.abrupt("return",o.toDataURL("image/".concat(i)));case 16:case"end":return e.stop()}}),e)})))).apply(this,arguments)}const c=function(e,t){return s.apply(this,arguments)},l=function(e){return new Promise((function(t){setTimeout(t,e)}))};var d="imageye___-_",u="origImg";const m=function(e,t,n){if(!e||!t||!n||e.includes("data:image/"))return e;var o=new URL(e);return o.searchParams.set(t,n),o.href};var p={PIXELS:"pixels",PAGE_INDEX:"index"},f="basedonurl",g={defaults:{savefoldername:f,donotbother:!1,numviews:0,allframes:!1,biggerview:!0,twocols:!0,newshown1:!1,doNotShowCopyright:!1,displayMode:"sidePanel",savefilename:"",savedownloadoptions:!0,convertfrom:"",convertto:"jpeg",minwidth:0,minheight:0,savesize:!1,sizetype:"any",imgtype:null,layout:null,urlpattern:"",sort:p.PIXELS}};for(var h in g.defaults)g[h]=g.defaults[h];function v(){return g.sort===p.PAGE_INDEX&&g.sizetype===g.defaults.sizetype&&g.imgtype===g.defaults.imgtype&&g.layout===g.defaults.layout&&g.urlpattern===g.defaults.urlpattern}function y(e,t,n){var o=function(e){if(e.includes("data:"))return"default";var t=new URL(e).pathname.split("/").pop();return t.includes(".")?decodeURI(t.split(".").slice(0,-1).join(".")):decodeURI(t)}(e),r=function(e){var t=e.name,n=e.type,o=e.index,r=(Number(o)||0)+1;return"imgi_".concat(r,"_").concat(t,".").concat(n)}({name:o,type:t,index:n}),a="".concat(o,".").concat(t);return(0===n||n)&&v()?"".concat(d).concat(r):"".concat(d).concat(a)}var w,b={darkmode:window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches,imageCT:new Object,allimages:new Object,downloadingErrorItems:[],redirectRequests:[],imagesCT:[],canDisplayInSidePanel:!1,stats:{types:{},sizes:{}},getImages:function(e){b.initiated=!1;var t=g.allframes;t&&(t=!e),b.allimages=new Object;var n='<div id="spinner" class="spinner"><span id="processedImages" style="position: absolute;top: -38px;left: 50%;transform:translateX(-50%);white-space:nowrap;"></span><div class="bounce1"></div><div class="bounce2"></div><div class="bounce3"></div></div>';$("#imgsContainer")[0].innerHTML.trim()!=n&&($("#imgsContainer")[0].innerHTML=n),chrome.tabs.query({active:!0,currentWindow:!0},(function(e){var n=e[0];if(!n||n.favIconUrl||n.title||n.url)b.currUrl=n.url,chrome.scripting.executeScript({target:{tabId:n.id,allFrames:t},files:["imageScraper.js"]},(function(e){b.getImagesCallback(e)}));else{var o=[{documentId:null,frameId:null,result:{images:[chrome.runtime.getURL("onboarding_1.jpg"),chrome.runtime.getURL("onboarding_2.jpg"),chrome.runtime.getURL("onboarding_3.jpg"),chrome.runtime.getURL("onboarding_4.jpg")],isArc:"",isTop:!0,origin:"",title:""}}];b.getImagesCallback(o)}}))},getImagesCallback:function(e){return o(a().mark((function t(){var n,o,r,i,s,c,l,d;return a().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!b.initiated){t.next=2;break}return t.abrupt("return");case 2:if(b.initiated=!0,!chrome.runtime.lastError&&e){t.next=19;break}n=chrome.runtime.lastError?chrome.runtime.lastError.message:"Cannot access images in this page.",chrome.runtime.lastError.message&&($("#imgsContainer")[0].style.padding="0px 20px",$("#imgsContainer")[0].style.position="relative",n='<div style="width:387px;"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="512" height="512" x="0" y="0" viewBox="0 0 201.526 201.526" style="enable-background:new 0 0 512 512;width: 65px;height: 65px;float: left;" xml:space="preserve" class=""><g><path d="M191.125,11.403H10.4C4.666,11.403,0,16.068,0,21.805v59.108c0,5.738,4.666,10.404,10.4,10.404h180.726     c5.734,0,10.4-4.666,10.4-10.403V21.805C201.525,16.068,196.86,11.403,191.125,11.403z M194.577,80.914h-0.001     c0,1.903-1.547,3.454-3.451,3.454H10.4c-1.904,0-3.451-1.551-3.451-3.454V21.805c0-1.903,1.547-3.454,3.451-3.454h180.726     c1.903,0,3.451,1.551,3.451,3.454V80.914z" fill="#333333" data-original="#000000" style="" class=""></path><path d="M63.924,35.968c-1.751-0.801-3.807-0.027-4.605,1.714L48.821,60.606l-3.19-6.696l6.109-13.338     c0.797-1.744,0.034-3.807-1.714-4.605c-1.751-0.801-3.811-0.027-4.605,1.714l-3.687,8.051l-3.859-8.099     c-0.825-1.734-2.888-2.477-4.628-1.642c-1.734,0.825-2.47,2.898-1.642,4.628l6.358,13.347l-3.04,6.638l-10.947-22.97     c-0.821-1.734-2.888-2.477-4.628-1.642c-1.734,0.825-2.47,2.898-1.642,4.628l14.143,29.686c0.573,1.211,1.795,1.982,3.135,1.982     c0.01,0,0.017,0,0.027,0c1.347-0.01,2.569-0.801,3.132-2.029l3.716-8.113l3.888,8.161c0.573,1.211,1.795,1.982,3.135,1.982     c0.01,0,0.017,0,0.027,0c1.347-0.01,2.569-0.801,3.132-2.029l13.596-29.686C66.434,38.83,65.671,36.766,63.924,35.968z" fill="#333333" data-original="#000000" style="" class=""></path><path d="M122.991,35.968c-1.754-0.801-3.807-0.027-4.605,1.714l-10.498,22.924l-3.19-6.696l6.109-13.338     c0.797-1.744,0.034-3.807-1.714-4.605c-1.751-0.801-3.807-0.027-4.604,1.714l-3.687,8.051l-3.859-8.099     c-0.821-1.734-2.891-2.477-4.628-1.642c-1.734,0.825-2.47,2.898-1.642,4.628l6.358,13.347l-3.04,6.638l-10.947-22.97     c-0.821-1.734-2.891-2.477-4.628-1.642c-1.734,0.825-2.47,2.898-1.642,4.628l14.143,29.686c0.573,1.211,1.795,1.982,3.135,1.982     c0.01,0,0.017,0,0.027,0c1.347-0.01,2.569-0.801,3.132-2.029l3.716-8.113l3.888,8.161c0.573,1.211,1.795,1.982,3.135,1.982     c0.01,0,0.017,0,0.027,0c1.347-0.01,2.569-0.801,3.132-2.029l13.596-29.686C125.502,38.83,124.739,36.766,122.991,35.968z" fill="#333333" data-original="#000000" style="" class=""></path><path d="M182.059,35.968c-1.751-0.801-3.807-0.027-4.605,1.714l-10.498,22.924l-3.19-6.696l6.109-13.338     c0.797-1.744,0.034-3.807-1.714-4.605c-1.751-0.801-3.807-0.027-4.605,1.714l-3.687,8.051l-3.859-8.099     c-0.821-1.734-2.888-2.477-4.628-1.642c-1.734,0.825-2.47,2.898-1.642,4.628l6.358,13.347l-3.04,6.638l-10.946-22.971     c-0.821-1.734-2.888-2.477-4.628-1.642c-1.734,0.825-2.47,2.898-1.642,4.628l14.143,29.686c0.573,1.211,1.795,1.982,3.135,1.982     c0.01,0,0.017,0,0.027,0c1.347-0.01,2.569-0.801,3.132-2.029l3.716-8.113l3.888,8.161c0.573,1.211,1.795,1.982,3.135,1.982     c0.01,0,0.017,0,0.027,0c1.347-0.01,2.569-0.801,3.132-2.029l13.596-29.686C184.57,38.83,183.806,36.766,182.059,35.968z" fill="#333333" data-original="#000000" style="" class=""></path><path d="M183.461,140.316L130.3,97.208c-1.065-0.865-2.545-1.018-3.766-0.397c-1.222,0.621-1.965,1.907-1.893,3.278l3.627,68.345     c0.078,1.455,1.055,2.708,2.45,3.139c1.384,0.421,2.904-0.061,3.787-1.222c0.065-0.081,5.398-7.075,11.231-12.901l15.68,30.776     c0.417,0.821,1.143,1.442,2.022,1.727c0.35,0.112,0.713,0.17,1.072,0.17c0.543,0,1.086-0.129,1.578-0.38l12.385-6.311     c0.821-0.417,1.442-1.143,1.727-2.022c0.285-0.876,0.21-1.829-0.21-2.65l-15.68-30.772c8.14-1.293,16.932-1.5,17.037-1.5     c1.455-0.034,2.742-0.97,3.213-2.348C185.031,142.759,184.594,141.232,183.461,140.316z M158.337,142.055     c-1.045,0.238-1.92,0.943-2.375,1.914c-0.451,0.97-0.434,2.097,0.054,3.05l16.206,31.8l-6.192,3.156l-16.206-31.804     c-0.485-0.953-1.384-1.632-2.436-1.832c-0.217-0.044-0.438-0.065-0.658-0.065c-0.831,0-1.646,0.298-2.283,0.859     c-3.444,3.003-6.926,6.756-9.715,9.972l-2.734-51.576l40.117,32.53C167.876,140.426,162.793,141.037,158.337,142.055z" fill="#333333" data-original="#000000" style="" class=""></path></g></svg><div style="float: left;padding-left: 15px;width:300px;">Visit a website and you will be able to find and download all the images...</div></div>',n='\n                Welcome to <b>Imageye extension</b>.<br>\n                <br>\n                This extension operates on most websites except for ones where the browser restricts scripting, including the extension web store, browser settings pages, and other extensions.<br>\n                <br>\n                Why not take it for a spin somewhere else, for example try <a href="#" class="trythisone">this one</a>. Have fun! &#129321;<br>\n                <br>\n                <span style="color:gray">'.concat(chrome.runtime.lastError.message,"</span>\n                ")),(o=document.createElement("div")).innerHTML="<div style='font-size:15px;position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);width:70%;max-width:300px;margin-top:-20px;'>".concat(n,"</center>"),o.style.width="100%",o.style.height="100%",$("#imgsContainer")[0].appendChild(o),document.querySelector(".trythisone").onclick=function(){chrome.tabs.query({active:!0,currentWindow:!0},(function(e){var t=e[0];chrome.tabs.update(t.id,{url:"https://www.google.com/search?tbm=isch&q=puppies"},(function(){setTimeout((function(){document.location.reload()}),1e3)}))}))},document.querySelector("#numimagesfound span").innerHTML=document.querySelectorAll(".imgContainer:not(.excluded)").length,document.getElementById("spinner").style.display="none",document.getElementById("searchingimages").style.display="none",document.getElementById("numimagesfound").style.display="",document.getElementById("selectalla").style.visibility="visible",t.next=50;break;case 19:for(e[0]&&e[0].result&&e[0].result.isArc&&(b.canDisplayInSidePanel=!1,document.querySelector(".displayInSidePanelPref").style.display="none","popup"!=g.displayMode&&(console.log("detected ARC browser, changing display mode to popup"),chrome.tabs.query({active:!0,currentWindow:!0},(function(e){chrome.runtime.sendMessage({msg:"changeDisplayMode",tabId:e[0].id,displayMode:"popup"},(function(){}))})))),r=0,i=0;i<e.length;i++)null!=e[i]&&null!=e[i].result.images&&e[i].result.images.length>0&&(r+=e[i].result.images.length);if(0!=r){t.next=26;break}return b.foundlastimage(),t.abrupt("return");case 26:(s=document.createElement("div")).id="loadingBack",s.className="disableBackround",s.style.top="".concat($("#imgsContainer").offset().top,"px"),(c=document.createElement("div")).innerHTML="analyzing 0 of ".concat(r," images"),c.className="progressText",c.style.width="auto",s.appendChild(c),$("#imgsContainer")[0].appendChild(s);try{for(i=0;i<e.length;i++)null!=e[i]&&e[i].result&&e[i].result.isTop&&(l=e[i].result.origin)}catch(e){console.log(e)}b.addReferrerRules(l),i=0;case 39:if(!(i<e.length)){t.next=50;break}if(null!=e[i]&&null!=e[i].result.images){t.next=42;break}return t.abrupt("continue",47);case 42:return d=e[i].result.images,e[i].result.isTop&&(b.title=e[i].result.title),t.next=46,b.addImages(d,r);case 46:b.foundlastimage();case 47:i++,t.next=39;break;case 50:console.log("\n          ----------------------------------------------------------------------------------------------------\n          COPYRIGHT (C) 2023 IMAGEYE\n\n          This source code is protected under Registered Copyright Ref Number: 19514190123S022. Any reproduction,\n          modification, distribution, or republication of this code, or any part thereof is strictly prohibited.\n\n          This code includes proprietary and confidential information. Any use of this code,\n          or any 'look and feel' components derived from it, is illegal and will result in legal action.\n\n          In the event of unauthorized use or infringement, we reserve the right to take legal action \n          to the maximum extent possible under the law, including criminal prosecution.\n          ----------------------------------------------------------------------------------------------------\n        ");case 51:case"end":return t.stop()}}),t)})))()},addImages:function(e,t){return o(a().mark((function n(){var r,i,s;return a().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return s=function(){return(s=o(a().mark((function n(){var o,s,c;return a().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(o=[],e.length){n.next=3;break}return n.abrupt("return");case 3:for(s=0;s<30;s++)(c=e.pop())&&o.push({image:c,index:e.length}),t&&$(".progressText")[0]&&($(".progressText")[0].innerHTML="analyzing ".concat(t-e.length," of ").concat(t," images"));return n.next=6,Promise.all(o.map((function(e){return r(b.addImage(e.image,!1,e.index),2e3).catch((function(e){}))})));case 6:return n.next=8,i();case 8:case"end":return n.stop()}}),n)})))).apply(this,arguments)},i=function(){return s.apply(this,arguments)},b.initCTListeners(),r=function(e,t){return Promise.race([e,new Promise((function(e,n){return setTimeout(n,t)}))])},n.next=6,i();case 6:case"end":return n.stop()}}),n)})))()},addImage:function(e,t,n){return o(a().mark((function r(){return a().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.abrupt("return",new Promise((function(r){try{b.allimages[e]&&r(!1),b.allimages[e]=e;var i=document.createElement("img");i.src=e,i.style.maxWidth="600px",i.className=u,i.id=e,i.setAttribute("index",n),i.onerror=o(a().mark((function e(){return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r(!1);case 1:case"end":return e.stop()}}),e)}))),i.onload=function(){var e=o(a().mark((function e(n){var o,s,c,l,d,u,m,f,h,v,y,w,C,x,M,L;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:e.prev=0,n.target.style.maxWidth="",o=n.target.src,s=o.toLowerCase(),c=n.target.getAttribute("index"),(l=document.createElement("div")).className="imgContainer",d=n.target.width,u=n.target.height,m=d*u,l.setAttribute("pixels",m),l.setAttribute("width",d),l.setAttribute("height",u),l.setAttribute("index",c),m<4e4&&l.setAttribute("sizeType","small"),m>=4e4&&l.setAttribute("sizeType","medium"),m>=48e4&&l.setAttribute("sizeType","large"),d>=1.2*u?l.setAttribute("layout","wide"):u>=1.2*d?l.setAttribute("layout","tall"):l.setAttribute("layout","square"),f=o,-1!=o.indexOf("data:image/")&&(f="".concat(o.substring(0,50),"...").concat(o.substring(o.length-50,o.length))),(h=document.createElement("input")).className="imgInput",h.value=f,v=b.getImgType(o),l.setAttribute("type",v),(y=document.createElement("div")).className="imgInfo",y.innerHTML="\n                            <div class='imgSize imgDimension' style='margin-left:5px;'>-</div>\n                            <div class='imgSize'>".concat(n.target.width,"x").concat(n.target.height,"</div>\n                            <div class='imgSize imgType' style='margin-right:5px;'>").concat(v,"</div>\n                            <div class='imgActions'>\n                                <input type='checkbox'>\n                                <img class='zoomIcon' title=\"").concat(chrome.i18n.getMessage("openinnewtab"),'" src=\'/newtab.png\' />\n                                <span class="showTooltipOnHover">\n                                    <img class=\'zoomIcon downloadIcon\' src=\'data:image/svg+xml;utf8;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iaXNvLTg4NTktMSI/Pgo8IS0tIEdlbmVyYXRvcjogQWRvYmUgSWxsdXN0cmF0b3IgMTguMS4xLCBTVkcgRXhwb3J0IFBsdWctSW4gLiBTVkcgVmVyc2lvbjogNi4wMCBCdWlsZCAwKSAgLS0+CjxzdmcgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayIgdmVyc2lvbj0iMS4xIiBpZD0iQ2FwYV8xIiB4PSIwcHgiIHk9IjBweCIgdmlld0JveD0iMCAwIDI5Ljk3OCAyOS45NzgiIHN0eWxlPSJlbmFibGUtYmFja2dyb3VuZDpuZXcgMCAwIDI5Ljk3OCAyOS45Nzg7IiB4bWw6c3BhY2U9InByZXNlcnZlIiB3aWR0aD0iMjRweCIgaGVpZ2h0PSIyNHB4Ij4KPGc+Cgk8cGF0aCBkPSJNMjUuNDYyLDE5LjEwNXY2Ljg0OEg0LjUxNXYtNi44NDhIMC40ODl2OC44NjFjMCwxLjExMSwwLjksMi4wMTIsMi4wMTYsMi4wMTJoMjQuOTY3YzEuMTE1LDAsMi4wMTYtMC45LDIuMDE2LTIuMDEyICAgdi04Ljg2MUgyNS40NjJ6IiBmaWxsPSIjMDAwMDAwIi8+Cgk8cGF0aCBkPSJNMTQuNjIsMTguNDI2bC01Ljc2NC02Ljk2NWMwLDAtMC44NzctMC44MjgsMC4wNzQtMC44MjhzMy4yNDgsMCwzLjI0OCwwczAtMC41NTcsMC0xLjQxNmMwLTIuNDQ5LDAtNi45MDYsMC04LjcyMyAgIGMwLDAtMC4xMjktMC40OTQsMC42MTUtMC40OTRjMC43NSwwLDQuMDM1LDAsNC41NzIsMGMwLjUzNiwwLDAuNTI0LDAuNDE2LDAuNTI0LDAuNDE2YzAsMS43NjIsMCw2LjM3MywwLDguNzQyICAgYzAsMC43NjgsMCwxLjI2NiwwLDEuMjY2czEuODQyLDAsMi45OTgsMGMxLjE1NCwwLDAuMjg1LDAuODY3LDAuMjg1LDAuODY3cy00LjkwNCw2LjUxLTUuNTg4LDcuMTkzICAgQzE1LjA5MiwxOC45NzksMTQuNjIsMTguNDI2LDE0LjYyLDE4LjQyNnoiIGZpbGw9IiMwMDAwMDAiLz4KCTxnPgoJPC9nPgoJPGc+Cgk8L2c+Cgk8Zz4KCTwvZz4KCTxnPgoJPC9nPgoJPGc+Cgk8L2c+Cgk8Zz4KCTwvZz4KCTxnPgoJPC9nPgoJPGc+Cgk8L2c+Cgk8Zz4KCTwvZz4KCTxnPgoJPC9nPgoJPGc+Cgk8L2c+Cgk8Zz4KCTwvZz4KCTxnPgoJPC9nPgoJPGc+Cgk8L2c+Cgk8Zz4KCTwvZz4KPC9nPgo8Zz4KPC9nPgo8Zz4KPC9nPgo8Zz4KPC9nPgo8Zz4KPC9nPgo8Zz4KPC9nPgo8Zz4KPC9nPgo8Zz4KPC9nPgo8Zz4KPC9nPgo8Zz4KPC9nPgo8Zz4KPC9nPgo8Zz4KPC9nPgo8Zz4KPC9nPgo8Zz4KPC9nPgo8Zz4KPC9nPgo8Zz4KPC9nPgo8L3N2Zz4K\' />\n                                    <div class="tooltip downloadImgAction">\n                                        <p style="padding-top:10px;"><b>Download as:</b></p>\n                                        <p class="download-type" dtype="original">Original (').concat(v,')</p>\n                                        <p class="download-type" dtype="jpeg">JPEG</p>\n                                        <p class="download-type" dtype="png">PNG</p>\n                                        <p class="download-type" dtype="webp">WEBP</p>\n                                    </div>\n                                </span>\n                                ').concat([".jpg",".jpeg",".png",".webp",".ico"].some((function(e){return s.includes(e)}))&&s.includes("http")?"<img class='zoomIcon searchsimilarimgs' title='".concat(chrome.i18n.getMessage("searchsimilarimgs"),"' src='/searchsimilarimgs.png' />"):"","\n                            </div>\n                        "),l.appendChild(n.target),l.appendChild(h),l.appendChild(y),l.setAttribute("imgsrc",o),w=document.getElementsByClassName("imgContainer"),C=!1,e.prev=34,x=0;case 36:if(!(x<w.length)){e.next=51;break}if(g.sort!==p.PIXELS){e.next=44;break}if(!(parseInt(m)>parseInt(w[x].getAttribute("pixels")))){e.next=42;break}return $(w[x]).before(l),C=!0,e.abrupt("break",51);case 42:e.next=48;break;case 44:if(!(parseInt(c)<parseInt(w[x].getAttribute("index")))){e.next=48;break}return $(w[x]).before(l),C=!0,e.abrupt("break",51);case 48:x++,e.next=36;break;case 51:e.next=55;break;case 53:e.prev=53,e.t0=e.catch(34);case 55:if(C||document.getElementById("imgsContainer").appendChild(l),l.style.display="-webkit-box",n.target.width>d&&(n.target.width=d),l.onclick=function(e){"imgInput"!=e.target.className&&("zoomIcon"!=e.target.className?"zoomIcon searchsimilarimgs"!=e.target.className?"zoomIcon downloadIcon"!=e.target.className?"download-type"!=e.target.className?b.selectImg(this):b.downloadImages([i],e.target.getAttribute("dtype")):b.downloadImages([i]):chrome.tabs.create({url:" https://lens.google.com/uploadbyurl?url=".concat(encodeURIComponent(o)),active:!0}):chrome.tabs.create({url:o,active:"sidePanel"==g.displayMode}))},t&&l.scrollIntoView(),0==o.indexOf("data:image/")){M=o;try{L=o.split(",").pop(),M=atob(L)}catch(e){}l.querySelector(".imgDimension").innerHTML=b.formatBytes(M.length,0)}$("#imgsContainer").attr("finished")&&b.populateStats(),r(!0),e.next=68;break;case 65:e.prev=65,e.t1=e.catch(0),r(!1);case 68:case"end":return e.stop()}}),e,null,[[0,65],[34,53]])})));return function(t){return e.apply(this,arguments)}}()}catch(e){console.log("addImage error + ".concat(e)),r(!1)}})));case 1:case"end":return r.stop()}}),r)})))()},selectImg:function(e,t,n){var o=e.querySelector('input[type="checkbox"]');(t?n:!e.classList.contains("imgSelected"))?(o.checked="checked",e.classList.add("imgSelected")):(o.checked="",e.classList.remove("imgSelected"));var r=$(".imgContainer:not(.excluded)"),a=$(".imgContainer.imgSelected:not(.excluded)").length;0==a?($("#downloadButton")[0].style.display="none",$("#foundimagesinnerdiv")[0].style.display=""):($("#downloadButton label")[0].innerHTML=chrome.i18n.getMessage("manyfilesnum").replace("%n",a),$("#downloadButton")[0].style.display="",$("#foundimagesinnerdiv")[0].style.display="none"),$("#selectalla")[0].innerHTML=r.length==a?chrome.i18n.getMessage("deselectall"):chrome.i18n.getMessage("selectall")},showPrefs:function(){document.body.classList.contains("showPrefs")?document.body.classList.remove("showPrefs"):($("#donotbother")[0].checked=!!g.donotbother,$("#allframes")[0].checked=!!g.allframes,$("#biggerview")[0].checked=!!g.biggerview,$("#twocols")[0].checked=!!g.twocols,$("#displayInSidePanel")[0].checked="sidePanel"==g.displayMode,$("#downloadseparatefolder").prop("checked",g.savedownloadoptions),g.savedownloadoptions?$("#downloadocationcontainer").show():$("#downloadocationcontainer").hide(),$("#savefoldernamePrefs").val(g.savefoldername),$("#savefilenamePrefs").val(g.savefilename),$("#convertFromPrefs").val(g.convertfrom),$("#convertToPrefs").val(g.convertto),$("#openHotKeyPrefs")[0].onclick=function(e){e.preventDefault(),chrome.tabs.create({url:"chrome://extensions/shortcuts",active:!0}),setTimeout(b.showPrefs,500)},chrome.commands.getAll((function(e){var t=e[0].shortcut;$("#openHotKeyPrefs")[0].innerHTML=t||"Not set"})),document.body.classList.add("showPrefs"),chrome.storage.sync.set({newshown1:!0}))},savePrefs:function(){g.donotbother=$("#donotbother")[0].checked,g.biggerview=$("#biggerview")[0].checked,g.twocols=$("#twocols")[0].checked,g.allframes=$("#allframes")[0].checked;var e=$("#displayInSidePanel")[0].checked?"sidePanel":"popup",t=e!=g.displayMode;g.displayMode=e,chrome.storage.sync.set({donotbother:g.donotbother,biggerview:g.biggerview,twocols:g.twocols,allframes:g.allframes,displayMode:g.displayMode}),b.saveDownloadOptionsFromPrefs(),document.body.classList.remove("showPrefs"),t&&chrome.tabs.query({active:!0,currentWindow:!0},(function(e){var t=e[0];chrome.runtime.sendMessage({msg:"changeDisplayMode",tabId:t.id,displayMode:g.displayMode},(function(){window.close()}))}))},showRating:function(){document.body.classList.contains("showRating")?document.body.classList.remove("showRating"):document.body.classList.add("showRating")},openRatingTab:function(){window.open("https://chromewebstore.google.com/detail/image-downloader-imageye/agionbommeaifngbhincahgmoflcikhm/reviews")},downloadImage:(w=o(a().mark((function e(t,n,o){var r,s,d,u,p;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("downloadImage",t,n,o),e.prev=1,r=o||$("#convertTo").val(),s=b.getImgType(t),d="original"!==o&&(o||[s,"ALL"].includes($("#convertFrom").val()))?r.toLowerCase():s.toLowerCase(),e.next=7,c(t,d);case 7:if(u=e.sent){e.next=11;break}return chrome.downloads.download({url:v()?m(t,"index",String(n)):t,conflictAction:"uniquify"}),e.abrupt("return");case 11:return p=y(t,d,n),i(p,u),e.next=15,l(100);case 15:e.next=20;break;case 17:e.prev=17,e.t0=e.catch(1),console.log("error while converting image",e.t0);case 20:case"end":return e.stop()}}),e,null,[[1,17]])}))),function(e,t,n){return w.apply(this,arguments)}),removeReferrersRules:function(){return o(a().mark((function e(){return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,chrome.declarativeNetRequest.updateSessionRules({removeRuleIds:[12345344]});case 3:e.next=8;break;case 5:e.prev=5,e.t0=e.catch(0),console.log(e.t0);case 8:case"end":return e.stop()}}),e,null,[[0,5]])})))()},addReferrerRules:function(e){return o(a().mark((function t(){return a().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(b.removeReferrersRules(),e=e||b.active_tab_origin,b.active_tab_origin=e,t.prev=3,!e){t.next=7;break}return t.next=7,chrome.declarativeNetRequest.updateSessionRules({addRules:[{id:12345344,priority:1,action:{type:"modifyHeaders",requestHeaders:[{header:"Referer",operation:"set",value:e}]},condition:{urlFilter:"|http*",resourceTypes:["image"],initiatorDomains:[chrome.runtime.id]}}]});case 7:t.next=12;break;case 9:t.prev=9,t.t0=t.catch(3),console.log(t.t0);case 12:case"end":return t.stop()}}),t,null,[[3,9]])})))()},downloadImages:function(e,t){return o(a().mark((function n(){var o,r,i,s,c,d,u,m,p,h,v;return a().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(null!=e&&e.length){n.next=2;break}return n.abrupt("return");case 2:b.addReferrerRules(),o={filename:$("#savefilename").val(),foldername:$("#savefoldername").val()==f?b.title:$("#savefoldername").val()},chrome.runtime.sendMessage({msg:"setDownloadOptions",downloadOptions:o},(function(){})),(r=document.createElement("div")).className="disableBackround",i=document.createElement("progress"),(s=document.createElement("div")).className="progressText",(c=document.createElement("div")).innerHTML="do not leave this page until complete",c.style.fontSize="14px",c.className="progressText",c.style.marginTop="22px",r.appendChild(i),r.appendChild(s),r.appendChild(c),(d=document.createElement("div")).className="progressText",d.style.marginTop="0px",d.style.bottom="0px",d.style.top="auto",d.style.fontSize="14px",d.innerHTML="The images you are downloading may be protected by copyright. Before using an image, make sure you check its license and the specific terms of reuse.",r.appendChild(d),document.body.appendChild(r),i.max=e.length,u=0;case 29:if(!(u<e.length)){n.next=40;break}return m=e[u],p=m.src,h=m.getAttribute("index"),n.next=35,Promise.race([b.downloadImage(p,h,t),l(3e3)]);case 35:i.value=u+1,s.innerHTML="downloading image ".concat(u+1," of ").concat(e.length);case 37:u+=1,n.next=29;break;case 40:if(s.innerHTML="Download complete!",c.style.display="none",(v=document.createElement("div")).className="progressText downloadButton",v.style.marginTop="40px",v.style.width="auto",v.style.paddingLeft=v.style.paddingRight="26px",v.innerHTML="Close",r.appendChild(v),!g.doNotShowCopyright||!e.length){n.next=56;break}return v.style.display="none",n.next=53,new Promise((function(e){return setTimeout(e,400)}));case 53:r.remove(),n.next=57;break;case 56:v.onclick=r.onclick=function(){g.doNotShowCopyright||(chrome.storage.sync.set({doNotShowCopyright:!0}),g.doNotShowCopyright=!0),r.remove()};case 57:setTimeout(b.removeReferrersRules,1e4);case 58:case"end":return n.stop()}}),n)})))()},init:function(){if(chrome.tabs.onUpdated.addListener((function(e,t,n){t.url&&n.id===b.tabid&&document.location.reload()})),document.body.classList.add(g.displayMode),b.canDisplayInSidePanel||(document.querySelector(".displayInSidePanelPref").style.display="none"),g.biggerview&&$("#container").addClass("bigger"),g.newshown1&&$("body").addClass("newshown1"),g.twocols&&$("#container").addClass("twocols"),b.localize(),b.initSizeMenu(),b.initSortMenu(),b.getImages(),chrome.downloads.onChanged.addListener((function(e){chrome.tabs.query({active:!0,currentWindow:!0},(function(t){b.tabid==t[0].id&&chrome.downloads.search({id:e.id},function(){var e=o(a().mark((function e(t){var n,o,r,s;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if((n=t[0]).byExtensionId!=chrome.runtime.id||!n.error||n.canResume){e.next=14;break}if(!b.downloadingErrorItems[n.id]&&"USER_CANCELED"!=n.error){e.next=4;break}return e.abrupt("return");case 4:return console.log("error downloading ".concat(n.id,", image ").concat(n.url," will retry with conversion")),b.downloadingErrorItems[n.id]=!0,o=new URL(n.url).searchParams.get("index"),e.next=9,c(n.url,"JPEG");case 9:if(r=e.sent){e.next=12;break}return e.abrupt("return");case 12:s=y(n.url,"jpeg",o),i(s,r);case 14:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())}))})),$(".showDownloadOptions svg").on("click",(function(e){if($(".showDownloadOptions .downloadMenu").is(":visible"))return $(".showDownloadOptions .downloadMenu").hide(),b.saveDownloadOptions(),void $(".downloadMenuCover").remove();$(".showDownloadOptions .downloadMenu").show();var t=document.querySelector(".downloadMenuCover");t&&t.remove(),(t=document.createElement("div")).className="downloadMenuCover",$("#downloadButton").before(t),t.onclick=function(e){b.saveDownloadOptions(),$(".showDownloadOptions .downloadMenu").hide(),t.remove()}})),$(".savedownloadoptions").on("click",(function(e){$(".savedownloadoptions").hasClass("selected")?$(".savedownloadoptions").removeClass("selected"):$(".savedownloadoptions").addClass("selected")})),$("#downloadseparatefolder").on("change",(function(e){this.checked?$("#downloadocationcontainer").show():$("#downloadocationcontainer").hide()})),$("#savefoldername").val(g.defaults.savefoldername),$("#savefilename").val(g.defaults.savefilename),g.savedownloadoptions){var t=g.savefoldername;t!=g.defaults.savefoldername&&(t=sanitize(t,{replacement:"_"})),$("#savefoldername").val(t);var n=sanitize(g.savefilename,{replacement:"_"});$("#savefilename").val(n),$("#convertFrom").val(g.convertfrom),$("#convertTo").val(g.convertto)}g.savedownloadoptions?$(".savedownloadoptions").addClass("selected"):$(".savedownloadoptions").removeClass("selected"),b.setDownloadOptionsChanged(),$("#reloadImageye")[0].onclick=function(){document.location.reload()},$("#showPrefs")[0].onclick=b.showPrefs,$("#saveprefscancel")[0].onclick=b.showPrefs,$("#saveprefs")[0].onclick=b.savePrefs,$("#saveaslink")[0].onclick=function(){event.preventDefault(),chrome.tabs.create({url:"chrome://settings/downloads",active:!0})},$("#biggerview")[0].onclick=function(){$("#biggerview")[0].checked?$("#container").addClass("bigger"):$("#container").removeClass("bigger")},$("#twocols")[0].onclick=function(){$("#twocols")[0].checked?$("#container").addClass("twocols"):$("#container").removeClass("twocols")},document.querySelector(".twoColsPref").onclick=function(){g.twocols=!g.twocols,g.twocols?$("#container").addClass("twocols"):$("#container").removeClass("twocols"),chrome.storage.sync.set({twocols:g.twocols})},$("#selectalla")[0].onclick=function(){var e=$(".imgContainer:not(.excluded)"),t=$(".imgContainer.imgSelected:not(.excluded)").length,n=e.length!=t;e.each((function(){b.selectImg(this,!0,n)}))},$(".showDownloadOptions")[0].onclick=function(e){e.stopPropagation(),e.preventDefault()},$("#downloadButton")[0].onclick=function(){$(".showDownloadOptions .downloadMenu").is(":visible")&&($(".showDownloadOptions .downloadMenu").hide(),b.saveDownloadOptions(),$(".downloadMenuCover").remove());var t,n=function(t){if(Array.isArray(t))return e(t)}(t=document.querySelectorAll(".imgContainer.imgSelected:not(.excluded) .".concat(u)))||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(t)||function(t,n){if(t){if("string"==typeof t)return e(t,n);var o=Object.prototype.toString.call(t).slice(8,-1);return"Object"===o&&t.constructor&&(o=t.constructor.name),"Map"===o||"Set"===o?Array.from(t):"Arguments"===o||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(o)?e(t,n):void 0}}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}();if(n.length>2&&!g.donotbother)return-1!=navigator.userAgent.indexOf("Firefox")&&(chromemanyfileswarning.style.display="none",firefoxmanyfileswarning.style.display="block"),$("#manyfilesnum")[0].innerHTML=$("#manyfilesnum")[0].innerHTML.replace("%n",n.length),$("#manyfiles")[0].style.display="block",$("#manyfilesdownload")[0].onclick=function(){g.donotbother=$("#donotbotherme")[0].checked,chrome.storage.sync.set({donotbother:g.donotbother}),b.downloadImages(n),$("#manyfiles")[0].style.display="none"},$("#manyfilescancel")[0].onclick=function(){$("#manyfiles")[0].style.display="none"},void($("#donotbotherme")[0].checked=!1);b.downloadImages(n)},$("#filterbyurlinput").on("input",(function(e){var t=this.value,n=$(e.target).closest(".filters > div").find(".menuLabel");if(n.html("URL"),n.removeClass("changedMenu"),t&&(n.html(t),n.addClass("changedMenu")),13===e.keyCode){var o=$(e.target).closest(".selectMenu");o.hide(),o.removeClass("--active")}b.inputtimeout&&clearTimeout(b.inputtimeout),b.inputtimeout=setTimeout((function(){g.urlpattern=t,b.foundlastimage()}),300)})),$("#ratebutton")[0].onclick=b.openRatingTab,$("#rateclose")[0].onclick=b.showRating,$(".filters > div div[saveSize]").on("click",(function(e){var t=$(this);g.savesize?(g.savesize=!1,t.removeClass("selected"),b.saveSizeConf(!0)):(g.savesize=!0,t.addClass("selected"),b.saveSizeConf()),chrome.storage.sync.set({savesize:g.savesize})})),$(".filters > div").on("mousedown",(function(e){var t=$(this).find(".selectMenu");if(e.target!==t[0]&&!$.contains(t[0],e.target)){if(t.hasClass("--active"))t.hide();else{t[0].style.marginLeft="0px",t.show();var n=b.getAbsolutePosition(t[0]),o=n.left+n.width-document.querySelector("#container").offsetWidth;t[0].style.marginLeft="0px",o>0&&(t[0].style.marginLeft="".concat(-o,"px"))}t.toggleClass("--active")}})),$(document.body).on("mousedown",(function(e){$(".filters div").each((function(){var t=this,n=t==e.target;if($(e.target).parents().each((function(){this==t&&(n=!0)})),!n){var o=$(t).find(".selectMenu");o.hide(),o.removeClass("--active")}}))})),$(".sizeMenu").on("click",(function(e){var t=$(e.target).attr("sizeConf");if(t&&(g.sizetype=t,"custom"!=t)){$(this).find("div[sizeConf]").each((function(){$(this).removeClass("selected")})),g.minwidth=g.defaults.minwidth,g.minheight=g.defaults.minheight,$("#minwidthinput").val(g.minwidth),$("#minheightinput").val(g.minheight);var n=$(e.target).closest(".filters > div").find(".menuLabel");n.removeClass("changedMenu"),n.html("Size"),"any"!=t&&(n.addClass("changedMenu"),n.html(t.charAt(0).toUpperCase()+t.slice(1))),$(e.target).addClass("selected"),b.foundlastimage(),$(this).hide()}})),$("#minwidthinput").on("input",(function(e){e.preventDefault(),b.setCustomSize()})),$("#minheightinput").on("input",(function(e){e.preventDefault(),b.setCustomSize()})),$(".typeMenu").on("click",(function(e){g.imgtype=$(e.target).attr("typeConf"),0==g.imgtype.indexOf("any")&&(g.imgtype=g.defaults.imgtype),$(this).find("div[typeConf]").each((function(){$(this).removeClass("selected")}));var t=$(e.target).closest(".filters > div").find(".menuLabel");t.removeClass("changedMenu"),t.html("Type"),g.imgtype&&(t.addClass("changedMenu"),t.html(g.imgtype)),$(e.target).addClass("selected"),b.foundlastimage(),$(this).hide()})),$(".layoutMenu").on("click",(function(e){g.layout=$(e.target).attr("layoutConf"),0==g.layout.indexOf("any")&&(g.layout=g.defaults.layout),$(this).find("div[layoutConf]").each((function(){$(this).removeClass("selected")}));var t=$(e.target).closest(".filters > div").find(".menuLabel");t.removeClass("changedMenu"),t.html("Layout"),g.layout&&(t.addClass("changedMenu"),t.html(g.layout.charAt(0).toUpperCase()+g.layout.slice(1))),$(e.target).addClass("selected"),b.foundlastimage(),$(this).hide()})),$(".sortMenu").on("click",(function(e){g.sort=$(e.target).attr("sortconf"),$(this).find("div[sortconf]").each((function(){$(this).removeClass("selected")})),$(e.target).addClass("selected"),chrome.storage.sync.set({sort:g.sort}),$(this).hide();var t=document.querySelector("#imgsContainer"),n=Array.from(t.querySelectorAll(".imgContainer")).sort((function(e,t){return parseInt(e.getAttribute(g.sort))<parseInt(t.getAttribute(g.sort))?1:-1}));g.sort==p.PAGE_INDEX&&(n=n.reverse()),n.forEach((function(e){return t.appendChild(e)}))})),$(".clearFilters").on("click",(function(){b.saveSizeConf(!0),document.location.reload()})),$(".captureSelection").on("click",(function(){b.captureSelection()}))},setCustomSize:function(){g.sizetype="custom",g.minwidth=parseInt($("#minwidthinput").val()||0),g.minheight=parseInt($("#minheightinput").val()||0);var e=$("#sizeTab").find(".menuLabel");e.html("Size"),e.removeClass("changedMenu"),g.minwidth==g.defaults.minwidth&&g.minheight==g.defaults.minheight||(e.html("> ".concat(g.minwidth,"&times;").concat(g.minheight)),e.addClass("changedMenu")),$("#sizeTab").find("div[sizeConf]").each((function(){$(this).removeClass("selected")})),$("#sizeTab").find("div[sizeConf=custom]").addClass("selected"),b.foundlastimage()},getConf:function(e){chrome.tabs.query({active:!0,currentWindow:!0},(function(t){b.tabid=t[0].id,chrome.runtime.sendMessage({msg:"canDisplayInSidePanel"},(function(t){b.canDisplayInSidePanel=t,chrome.storage.sync.get(g.defaults,(function(t){for(var n in t)g[n]=t[n];g.displayMode=b.canDisplayInSidePanel?t.displayMode:"popup",e(),b.numviews=t.numviews+1;var o=b.numviews>1e3?1e5:b.numviews>100?1e3:b.numviews>10?100:10;b.numviews%o==0&&b.showRating(),chrome.storage.sync.set({numviews:b.numviews}),chrome.storage.sync.get("web2jpg",(function(e){if(e.web2jpg)try{chrome.storage.sync.remove("web2jpg"),g.convertfrom==g.defaults.convertfrom&&(g.convertfrom="WEBP",g.convertto="jpeg",chrome.storage.sync.set({convertfrom:g.convertfrom,convertto:g.convertto}),$("#convertFrom").val(g.convertfrom),$("#convertTo").val(g.convertto))}catch(e){}}))}))}))}))},captureSelection:function(){chrome.tabs.query({active:!0,currentWindow:!0},(function(e){var t=e[0];chrome.scripting.executeScript({target:{tabId:t.id},files:["captureSelection.js"]},(function(e){chrome.tabs.sendMessage(t.id,{msg:"initSelection"},(function(){chrome.runtime.onMessage.addListener(b.renderSelection)}))}))}))},renderSelection:function(e){if("returnSelection"===e.msg){var t=e.rect;chrome.runtime.onMessage.removeListener(b.renderSelection),setTimeout((function(){chrome.tabs.captureVisibleTab(null,{format:"png"},function(){var e=o(a().mark((function e(n){var o,r,i,s,c;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:o=document.querySelectorAll(".imgContainer").length,r=document.querySelector("#numimagesfound span"),i=new Image,s=document.createElement("canvas"),c=s.getContext("2d"),i.src=n,i.onload=function(){s.width=t.width,s.height=t.height,c.drawImage(i,t.x,t.y,t.width,t.height,0,0,s.width,s.height),b.addImage(s.toDataURL("image/png"),!0,o),r.innerHTML=String(o+1)};case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())}),500)}},foundlastimage:function(){return o(a().mark((function e(){var t,n,o;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:$("#loadingBack")[0]||"none"!=$("#spinner")[0].style.display||((t=document.createElement("div")).id="loadingBack",t.className="disableBackround",t.style.top="".concat($("#imgsContainer").offset().top,"px"),(n=document.createElement("div")).innerHTML="loading...",n.className="progressText",n.style.width="auto",t.appendChild(n),$("#imgsContainer")[0].appendChild(t),$(".statusdivcontainer")[0].style.zIndex="10000"),$("#loadingBack")[0]&&$("#loadingBack")[0].remove(),$(".statusdivcontainer")[0].style.zIndex="",o=b.imagesCT,g.savesize&&b.saveSizeConf(),$(".imgContainer").each((function(){var e=$(this);b.selectImg(this,!0,!1),e[0].className="imgContainer";var t=e.attr("imgsrc"),n=o[t],r=parseInt(e.attr("width")),a=parseInt(e.attr("height")),i=e.attr("sizeType"),s=e.attr("layout"),c=e.attr("type");"-"==c&&n&&(c=b.getImgType(t,n.mimeType))&&"-"!=c&&(e.find(".imgType").html(c),e.attr("type",c)),n&&n.contentLength&&e.find(".imgDimension").html(b.formatBytes(n.contentLength,0)),g.imgtype&&c!=g.imgtype&&e.addClass("excluded excludedType"),("any"!=g.sizetype&&"custom"!=g.sizetype&&g.sizetype!=i||!(r>=g.minwidth&&a>=g.minheight))&&e.addClass("excluded excludedSize"),-1==t.toLowerCase().indexOf(g.urlpattern.toLowerCase())&&e.addClass("excluded excludedUrl"),g.layout&&s!=g.layout&&e.addClass("excluded excludedLayout")})),b.populateStats(),$(".changedMenu").length>0?$(".clearFilters").show():$(".clearFilters").hide(),document.getElementById("spinner").style.display="none",document.querySelectorAll(".imgContainer").forEach((function(e){e.style.display="-webkit-box"})),document.getElementById("searchingimages").style.display="none",document.getElementById("numimagesfound").style.display="",document.getElementById("selectalla").style.visibility="visible",$("#imgsContainer").attr("finished",!0),b.removeReferrersRules(),b.stopCTListeners();case 16:case"end":return e.stop()}}),e)})))()},populateStats:function(){var e=".imgContainer:not(.excludedUrl):not(.excludedType):not(.excludedLayout)",t=".imgContainer:not(.excludedUrl):not(.excludedSize):not(.excludedLayout)",n=".imgContainer:not(.excludedUrl):not(.excludedSize):not(.excludedType)";b.stats={size:{any:$(e).length,small:$("".concat(e,"[sizeType='small']")).length,medium:$("".concat(e,"[sizeType='medium']")).length,large:$("".concat(e,"[sizeType='large']")).length},types:{any:$(t).length,JPG:$("".concat(t,"[type='JPG']")).length,GIF:$("".concat(t,"[type='GIF']")).length,PNG:$("".concat(t,"[type='PNG']")).length,SVG:$("".concat(t,"[type='SVG']")).length,WEBP:$("".concat(t,"[type='WEBP']")).length,BMP:$("".concat(t,"[type='BMP']")).length,ICO:$("".concat(t,"[type='ICO']")).length,TIFF:$("".concat(t,"[type='TIFF']")).length,AVIF:$("".concat(t,"[type='AVIF']")).length},layout:{any:$(n).length,square:$("".concat(n,"[layout='square']")).length,wide:$("".concat(n,"[layout='wide']")).length,tall:$("".concat(n,"[layout='tall']")).length}},$(".typeMenu").find("div[typeConf]").each((function(){var e=$(this).attr("typeConf"),t=b.stats.types[e];t=t||0,$(this).html("".concat(e.charAt(0).toUpperCase()+e.slice(1)," (").concat(t,")")),t||this.classList.add("zeroResults")})),$(".sizeMenu").find("div[sizeConf]").each((function(){var e=$(this).attr("sizeConf");if("custom"!=e){var t=b.stats.size[e];t=t||0,$(this).html("".concat(e.charAt(0).toUpperCase()+e.slice(1)," (").concat(t,")")),t||this.classList.add("zeroResults")}})),$(".layoutMenu").find("div[layoutConf]").each((function(){var e=$(this).attr("layoutConf"),t=b.stats.layout[e];t=t||0,$(this).html("".concat(e.charAt(0).toUpperCase()+e.slice(1)," (").concat(t,")")),t||this.classList.add("zeroResults")})),document.querySelector("#numimagesfound span").innerHTML=document.querySelectorAll(".imgContainer:not(.excluded)").length},getImgType:function(e,t){var n;try{if(0==e.indexOf("data:image/"))n=e.substring(11,-1!=e.indexOf(";")?e.indexOf(";"):e.indexOf(","));else{var o=e.split("?")[0].split("/").pop();o.includes(".")&&(n=o.substring(o.lastIndexOf(".")))}!n&&t&&(n=t,console.log("got mimeType from CT: ".concat(n)))}catch(e){}return n?-1!=(n=n.toLowerCase()).indexOf("jpg")||-1!=n.indexOf("jpeg")?"JPG":-1!=n.indexOf("gif")?"GIF":-1!=n.indexOf("png")?"PNG":-1!=n.indexOf("svg")?"SVG":-1!=n.indexOf("webp")?"WEBP":-1!=n.indexOf("bmp")?"BMP":-1!=n.indexOf("ico")?"ICO":-1!=n.indexOf("tiff")?"TIFF":-1!=n.indexOf("avif")?"AVIF":"-":"-"},localize:function(){for(var e=document.querySelectorAll(".localizedSpan"),t=0;t<e.length;t++){var n=chrome.i18n.getMessage(e[t].getAttribute("messagesKey"));n&&(e[t].innerHTML=n)}$("#filterbyurlinput")[0].setAttribute("placeholder",chrome.i18n.getMessage("filterbyurlinputplaceholder"))},formatBytes:function(e,t){if(0==e)return"0 B";var n=t,o=Math.floor(Math.log(e)/Math.log(1024));return"".concat(parseFloat((e/Math.pow(1024,o)).toFixed(n))," ").concat(["B","KB","MB","GB","TB","PB","EB","ZB","YB"][o])},saveSizeConf:function(e){chrome.storage.sync.set({sizetype:e?g.defaults.sizetype:g.sizetype,minwidth:e?g.defaults.minwidth:g.minwidth,minheight:e?g.defaults.minheight:g.minheight})},initSizeMenu:function(){var e=$("#sizeTab");if(g.minwidth==g.defaults.minwidth&&g.minheight==g.defaults.minheight||(g.savesize=!0,g.sizetype="custom"),g.savesize){e.find("div[sizeConf]").removeClass("selected"),e.find("div[sizeConf=".concat(g.sizetype,"]")).addClass("selected"),$("#minwidthinput").val(g.minwidth),$("#minheightinput").val(g.minheight),e.find(".savesize").addClass("selected");var t=e.find(".menuLabel");switch(g.sizetype){case"any":break;case"custom":t.addClass("changedMenu"),t.html("> ".concat(g.minwidth,"&times;").concat(g.minheight));break;default:t.addClass("changedMenu"),t.html(g.sizetype.charAt(0).toUpperCase()+g.sizetype.slice(1))}$(".changedMenu").length>0&&$(".clearFilters").show()}},initSortMenu:function(){var e=$("#sortTab");e.find("div[sortconf]").removeClass("selected"),e.find("div[sortconf=".concat(g.sort,"]")).addClass("selected")},getAbsolutePosition:function(e){var t=e.getBoundingClientRect();return t.x+=window.scrollX,t.y+=window.scrollY,t},getHeaderFromHeaders:function(e,t){for(var n=0;n<e.length;++n){var o=e[n];if(o.name.toLowerCase()===t)return o.value}},onBeforeRedirectListener:function(e){e.initiator===location.origin&&(b.redirectRequests[e.redirectUrl]=e.url)},onCompletedListener:function(e){if(e.initiator===location.origin){var t=b.redirectRequests[e.url]||e.url;b.imagesCT[t]={mimeType:b.getHeaderFromHeaders(e.responseHeaders,"content-type"),contentLength:b.getHeaderFromHeaders(e.responseHeaders,"content-length")}}},initCTListeners:function(){chrome.webRequest.onBeforeRedirect.addListener(b.onBeforeRedirectListener,{urls:["<all_urls>"],types:["image"]}),chrome.webRequest.onCompleted.addListener(b.onCompletedListener,{urls:["<all_urls>"],types:["image"]},["responseHeaders"])},stopCTListeners:function(){chrome.webRequest.onBeforeRedirect.removeListener(b.onBeforeRedirectListener),chrome.webRequest.onCompleted.removeListener(b.onCompletedListener)},saveDownloadOptions:function(){$(".savedownloadoptions").hasClass("selected")&&(g.savedownloadoptions=!0,g.savefoldername=$("#savefoldername").val(),g.savefoldername!=g.defaults.savefoldername&&(g.savefoldername=sanitize(g.savefoldername,{replacement:"_"})),g.savefilename=$("#savefilename").val(),g.savefilename=sanitize(g.savefilename,{replacement:"_"}),g.convertfrom=$("#convertFrom").val(),g.convertto=$("#convertTo").val(),chrome.storage.sync.set({savefoldername:g.savefoldername,savefilename:g.savefilename,savedownloadoptions:g.savedownloadoptions,convertfrom:g.convertfrom,convertto:g.convertto})),b.setDownloadOptionsChanged()},saveDownloadOptionsFromPrefs:function(){$("#downloadseparatefolder").is(":checked")?($(".savedownloadoptions").removeClass("selected").addClass("selected"),$("#savefoldername").val($("#savefoldernamePrefs").val()),$("#savefilename").val($("#savefilenamePrefs").val()),$("#convertFrom").val($("#convertFromPrefs").val()),$("#convertTo").val($("#convertToPrefs").val()),b.saveDownloadOptions()):g.savedownloadoptions&&(g.savedownloadoptions=!1,g.savefoldername=g.defaults.savefoldername,g.savefilename=g.defaults.savefilename,g.convertfrom=g.defaults.convertfrom,g.convertto=g.defaults.convertto,$(".savedownloadoptions").removeClass("selected"),$("#savefoldername").val(g.savefoldername),$("#savefilename").val(g.savefilename),$("#convertFrom").val(g.convertfrom),$("#convertTo").val(g.convertto),chrome.storage.sync.set({savefoldername:g.savefoldername,savefilename:g.savefilename,savedownloadoptions:g.savedownloadoptions,convertfrom:g.convertfrom,convertto:g.convertto}),b.setDownloadOptionsChanged())},setDownloadOptionsChanged:function(){$("#savefoldername").val()!=g.defaults.savefoldername||$("#savefilename").val()!=g.defaults.savefilename||$("#convertFrom").val()!=g.defaults.convertfrom?$(".showDownloadOptions").addClass("changed"):$(".showDownloadOptions").removeClass("changed")}};b.getConf(b.init)})()})();